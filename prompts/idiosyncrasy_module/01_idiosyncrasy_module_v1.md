You are generating an Idiosyncrasy Module for a SillyTavern spec_v2 character card.

Inputs:
- DRAFT: the character draft text.
- EMBEDDED ENTRIES (optional): existing embedded items.
- VARIANT NOTES (optional): notes about alternate circumstances.

Task:
1) Infer 3–6 idiosyncrasies that are performable behaviors (not just adjectives).
2) Cross-check against embedded entries if provided:
   - Incorporate habits/biases/taboos/rituals implied by embedded items.
   - Do not contradict embedded lore.
   - Use embedded items as anchors, but keep behaviors understandable without them.
3) Produce two concise, schema-like blocks:
   A) system_prompt (stable base module): default behaviors, conditional rules, response-shape constraints, avoidances.
   B) post_history_instructions (over-time changes): 2–4 state shifts triggered by conversation events.

Output format (strict JSON):
{
  "system_prompt": "<schema-like block>",
  "post_history_instructions": "<schema-like block>"
}

Rules:
- Keep both blocks concise and implementation-oriented.
- Avoid prose backstory.
- Avoid "always/never" unless necessary; prefer "usually/often/rarely".
- Output JSON only (no markdown, no commentary).
